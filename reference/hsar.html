<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hierarchical SAR model estimation — hsar • HSAR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Hierarchical SAR model estimation — hsar"><meta name="description" content="The specification of a HSAR model is as follows:
$$y_{i,j} = \rho *\mathbf{W}_i *\mathbf{y} + \mathbf{x}^\prime_{i,j} * \mathbf{\beta} +
   \mathbf{z}^\prime_j * \mathbf{\gamma} + \theta_j + \epsilon_{i,j}  $$
$$\theta_j = \lambda * \mathbf{M}_j * \mathbf{\theta} + \mu_j  $$
$$\epsilon_{i,j} \sim N(0,\sigma_e^2), \hspace{2cm} \mu_j \sim N(0,\sigma_u^2)$$
where \(i=1,2,...,n_j\) and \(j=1,2,...,J\) are indicators of lower- and higher-level spatial units. \(n_j\) is the number of lower-level units in the \(j-th\) higher level unit and \(\sum_{j=1}^J=\mathbf{N}\). \(\mathbf{x}^\prime_{i,j}\) and \(\mathbf{z}^\prime_j\) represent vectors of lower- and higher-level independent variables. \(\mathbf{\beta}\) and \(\mathbf{\gamma}\) are regression coefficients to estimate. \(\mathbf{\theta}\), a \(N \times J\) vector of higher-level random effects, also follows a simultaneous autoregressive process. \(\mathbf{W}\) and \(\mathbf{M}\) are two spatial weights matrices (or neighbourhood connection matrices) at the lower and higher levels, defining how spatial units at each level are connected. \(\rho\) and \(\lambda\) are two spatial autoregressive parameters measuring the strength of the dependencies/correlations at the two spatial scales.
A succinct matrix formulation of the model is,
$$\mathbf{y} = \rho * \mathbf{W} * \mathbf{y} + \mathbf{X} * \mathbf{\beta} +
   \mathbf{Z} * \mathbf{\gamma} + \Delta * \mathbf{\theta} + \mathbf{\epsilon} $$
$$\mathbf{\theta} = \lambda * \mathbf{M} * \mathbf{\theta} + \mathbf{\mu}$$
It is also useful to note that the HSAR model nests a standard (random intercept) multilevel model model when \(\rho\) and \(\lambda\) are both equal to zero and a standard spaital econometric model when \(\lambda\) and \(\sigma^2_u\) are both equal to zero."><meta property="og:description" content="The specification of a HSAR model is as follows:
$$y_{i,j} = \rho *\mathbf{W}_i *\mathbf{y} + \mathbf{x}^\prime_{i,j} * \mathbf{\beta} +
   \mathbf{z}^\prime_j * \mathbf{\gamma} + \theta_j + \epsilon_{i,j}  $$
$$\theta_j = \lambda * \mathbf{M}_j * \mathbf{\theta} + \mu_j  $$
$$\epsilon_{i,j} \sim N(0,\sigma_e^2), \hspace{2cm} \mu_j \sim N(0,\sigma_u^2)$$
where \(i=1,2,...,n_j\) and \(j=1,2,...,J\) are indicators of lower- and higher-level spatial units. \(n_j\) is the number of lower-level units in the \(j-th\) higher level unit and \(\sum_{j=1}^J=\mathbf{N}\). \(\mathbf{x}^\prime_{i,j}\) and \(\mathbf{z}^\prime_j\) represent vectors of lower- and higher-level independent variables. \(\mathbf{\beta}\) and \(\mathbf{\gamma}\) are regression coefficients to estimate. \(\mathbf{\theta}\), a \(N \times J\) vector of higher-level random effects, also follows a simultaneous autoregressive process. \(\mathbf{W}\) and \(\mathbf{M}\) are two spatial weights matrices (or neighbourhood connection matrices) at the lower and higher levels, defining how spatial units at each level are connected. \(\rho\) and \(\lambda\) are two spatial autoregressive parameters measuring the strength of the dependencies/correlations at the two spatial scales.
A succinct matrix formulation of the model is,
$$\mathbf{y} = \rho * \mathbf{W} * \mathbf{y} + \mathbf{X} * \mathbf{\beta} +
   \mathbf{Z} * \mathbf{\gamma} + \Delta * \mathbf{\theta} + \mathbf{\epsilon} $$
$$\mathbf{\theta} = \lambda * \mathbf{M} * \mathbf{\theta} + \mathbf{\mu}$$
It is also useful to note that the HSAR model nests a standard (random intercept) multilevel model model when \(\rho\) and \(\lambda\) are both equal to zero and a standard spaital econometric model when \(\lambda\) and \(\sigma^2_u\) are both equal to zero."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HSAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/hsar.html">An application of HSAR for asking prices in the municipality of Athens</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/spatlyu/HSAR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hierarchical SAR model estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/spatlyu/HSAR/blob/main/R/hsar.R" class="external-link"><code>R/hsar.R</code></a></small>
      <div class="d-none name"><code>hsar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The specification of a HSAR model is as follows:
$$y_{i,j} = \rho *\mathbf{W}_i *\mathbf{y} + \mathbf{x}^\prime_{i,j} * \mathbf{\beta} +
   \mathbf{z}^\prime_j * \mathbf{\gamma} + \theta_j + \epsilon_{i,j}  $$
$$\theta_j = \lambda * \mathbf{M}_j * \mathbf{\theta} + \mu_j  $$
$$\epsilon_{i,j} \sim N(0,\sigma_e^2), \hspace{2cm} \mu_j \sim N(0,\sigma_u^2)$$
where \(i=1,2,...,n_j\) and \(j=1,2,...,J\) are indicators of lower- and higher-level spatial units. \(n_j\) is the number of lower-level units in the \(j-th\) higher level unit and \(\sum_{j=1}^J=\mathbf{N}\). \(\mathbf{x}^\prime_{i,j}\) and \(\mathbf{z}^\prime_j\) represent vectors of lower- and higher-level independent variables. \(\mathbf{\beta}\) and \(\mathbf{\gamma}\) are regression coefficients to estimate. \(\mathbf{\theta}\), a \(N \times J\) vector of higher-level random effects, also follows a simultaneous autoregressive process. \(\mathbf{W}\) and \(\mathbf{M}\) are two spatial weights matrices (or neighbourhood connection matrices) at the lower and higher levels, defining how spatial units at each level are connected. \(\rho\) and \(\lambda\) are two spatial autoregressive parameters measuring the strength of the dependencies/correlations at the two spatial scales.
A succinct matrix formulation of the model is,
$$\mathbf{y} = \rho * \mathbf{W} * \mathbf{y} + \mathbf{X} * \mathbf{\beta} +
   \mathbf{Z} * \mathbf{\gamma} + \Delta * \mathbf{\theta} + \mathbf{\epsilon} $$
$$\mathbf{\theta} = \lambda * \mathbf{M} * \mathbf{\theta} + \mathbf{\mu}$$
It is also useful to note that the HSAR model nests a standard (random intercept) multilevel model model when \(\rho\) and \(\lambda\) are both equal to zero and a standard spaital econometric model when \(\lambda\) and \(\sigma^2_u\) are both equal to zero.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hsar</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  W <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">Delta</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  Nsim <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  thinning <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  parameters.start <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A symbolic description of the model to fit. A formula for the covariate part of the model using the syntax of the lm() function fitting standard linear regression models. Neither the response variable nor the explanatory variables are allowed to contain NA values.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> containing variables used in the formula object.</p></dd>


<dt id="arg-w">W<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>The N by N lower-level spatial weights matrix or neighbourhood matrix where N is the total number of lower-level spatial units. The formulation of W could be based on geographical distances separating units or based on geographical contiguity. To ensure the maximum value of the spatial autoregressive parameter \(\rho\) less than 1,
W should be row-normalised before running the HSAR model. As in most cases, spatial weights matrix is very sparse, therefore W here should be converted to a sparse matrix before imported into the <code>hsar()</code> function to save computational burden and reduce computing time. More specifically, W should be a column-oriented numeric sparse matrices of
a <code>dgCMatrix</code> class defined in the <code>Matrix</code> package. The converion between a dense numeric matrix and a sparse numeric matrix is made quite convenient through the <code>Matrix</code>library.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>The J by J higher-level spatial weights matrix or neighbourhood matrix where J is the total number of higher-level spatial units. Similar with W, the formulation of M could be based on geographical distances separating units or based on geographical contiguity. To ensure the maximum value of the spatial autoregressive parameter \(\lambda\)
less than 1, M is also row-normalised before running the HSAR model. As with W, M should also be a column-oriented numeric sparse matrices.</p></dd>


<dt id="arg-delta">Delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>The N by J random effect design matrix that links the J by 1 higher-level random effect vector back to the N by 1 response variable under investigation. It is simply how lower-level units are grouped into each high-level units with columns of the matrix being each higher-level units. As with W and M, \(\delta\) should also be a
column-oriented numeric sparse matrices.</p></dd>


<dt id="arg-burnin">burnin<a class="anchor" aria-label="anchor" href="#arg-burnin"></a></dt>
<dd><p>The number of MCMC samples to discard as the burnin period.</p></dd>


<dt id="arg-nsim">Nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>The total number of MCMC samples to generate.</p></dd>


<dt id="arg-thinning">thinning<a class="anchor" aria-label="anchor" href="#arg-thinning"></a></dt>
<dd><p>MCMC thinning factor.</p></dd>


<dt id="arg-parameters-start">parameters.start<a class="anchor" aria-label="anchor" href="#arg-parameters-start"></a></dt>
<dd><p>A list with names "rho", "lambda", "sigma2e", "sigma2u" and "beta" corresponding to initial values for the model parameters \(\rho, \lambda, \sigma^2_e, \sigma^2_u\) and the regression coefficients respectively.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code>.</p><dl><dt>cbetas</dt>
<dd><p>A matrix with the MCMC samples of the draws for the coefficients.</p></dd>

<dt>Mbetas</dt>
<dd><p>A vector of estimated mean values of regression coefficients.</p></dd>

<dt>SDbetas</dt>
<dd><p>The standard deviations of estimated regression coefficients.</p></dd>

<dt>Mrho</dt>
<dd><p>The estimated mean of the lower-level spatial autoregressive parameter \(\rho\).</p></dd>

<dt>SDrho</dt>
<dd><p>The standard deviation of the estimated lower-level spatial autoregressive parameter.</p></dd>

<dt>Mlamda</dt>
<dd><p>The estimated mean of the higher-level spatial autoregressive parameter \(\lambda\).</p></dd>

<dt>SDlambda</dt>
<dd><p>The standard deviation of the estimated higher-level spatial autoregressive parameter.</p></dd>

<dt>Msigma2e</dt>
<dd><p>The estimated mean of the lower-level variance parameter \(\sigma^2_e\).</p></dd>

<dt>SDsigma2e</dt>
<dd><p>The standard deviation of the estimated lower-level variance parameter \(\sigma^{2}_{e} \).</p></dd>

<dt>Msigma2u</dt>
<dd><p>The estimated mean of the higher-level variance parameter \(\sigma^2_u\).</p></dd>

<dt>SDsigma2u</dt>
<dd><p>The standard deviation of the estimated higher-level variance parameter \(\sigma^2_u\).</p></dd>

<dt>Mus</dt>
<dd><p>Mean values of \(\theta\)</p></dd>

<dt>SDus</dt>
<dd><p>Standard deviation of \(\theta\)</p></dd>

<dt>DIC</dt>
<dd><p>The deviance information criterion (DIC) of the fitted model.</p></dd>

<dt>pd</dt>
<dd><p>The effective number of parameters of the fitted model.</p></dd>

<dt>Log_Likelihood</dt>
<dd><p>The log-likelihood of the fitted model.</p></dd>

<dt>R_Squared</dt>
<dd><p>A pseudo R square model fit indicator.</p></dd>

<dt>impact_direct</dt>
<dd><p>Summaries of the direct impact of a covariate effect on the outcome variable.</p></dd>

<dt>impact_idirect</dt>
<dd><p>Summaries of the indirect impact of a covariate effect on the outcome variable.</p></dd>

<dt>impact_total</dt>
<dd><p>Summaries of the total impact of a covariate effect on the outcome variable.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In order to use the hsar() function, users need to specify the two spatial weights matrices W and M and the random effect design matrix \(\delta\). However, it is very easy to extract such spatial weights matrices from spatial data using the package <span class="pkg">spdep</span>. Geographic distance-based or contiguity-based spatial weights matrix for both spatial points data and spatial polygons data are available in the <span class="pkg">spdep</span> package.
Before the extraction of W and M, it is better to first sort the data using the higher-level unit identifier. Then, the random effect design matrix can be extracted simply (see the following example) and so are the two spatial weights matrices. Make sure the order of higher-level units in the weights matrix M is in line with that in the \(\delta\) matrix.
Two simpler versions of the HSAR model can also be fitted using the hsar() function. The first is a HSAR model with \(\lambda\) equal to zero, indicating an assumption of independence in the higher-level random effect \(\mathbf{\theta}\). The second is a HSAR with \(\rho\) equal to zero, indicating an independence assumption in the outcome variable conditioning on the hgiher-level random effect. This model is useful in situations where we are interested in the neighbourhood/contextual effect on individual's outcomes and have good reasons to suspect the effect from geographical contexts upon individuals to be dependent. Meanwhile we have no information on how lower-level units are connnected.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dong, G. and Harris, R. 2015. Spatial Autoregressive Models for Geographically Hierarchical Data Structures. <em>Geographical Analysis</em>, 47:173-191.</p>
<p>LeSage, J. P., and R. K. Pace. (2009). <em>Introduction to Spatial Econometrics</em>. Boca Raton, FL: CRC Press/Taylor &amp; Francis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: spData</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To access larger datasets in this package, install the spDataLarge</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> package with: `install.packages('spDataLarge',</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> repos='https://nowosad.github.io/drat/', type='source')`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: sf</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Running the hsar() function using the Beijing land price data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">landprice</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load shapefiles of Beijing districts and land parcels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Beijingdistricts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">land</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Beijingdistricts</span>,border<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land</span>,add<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="st">"red"</span>,pch<span class="op">=</span><span class="fl">16</span>,cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ignoring all but the first attribute</span>
<span class="r-plt img"><img src="hsar-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the random effect matrix</span></span></span>
<span class="r-in"><span><span class="va">model.data</span> <span class="op">&lt;-</span> <span class="va">landprice</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">landprice</span><span class="op">$</span><span class="va">district.id</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model.data</span>,<span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     obs lnprice   lnarea  lndcbd dsubway   dpark    dele   popden crimerate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   190 7.16382 11.58780 9.93534 7.14334 6.78243 6.67827 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   992 7.45757  9.20029 9.84785 7.78904 6.95662 7.05138 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   189 5.57430 10.27820 9.94866 6.83023 7.06579 6.81916 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   993 7.12569  7.97788 9.84388 7.81991 7.00792 7.11267 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   969 6.81564  5.81928 9.91940 7.64640 6.88254 4.10025 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   994 7.48522  7.78634 9.84203 7.83398 7.03089 7.13981 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   968 7.61282  8.94551 9.91779 7.64360 6.84364 4.60356 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1001 5.87349 10.70910 9.95534 7.89121 7.11019 5.67984 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   970 6.93528  7.71869 9.91752 7.65810 6.86760 4.53460 0.548966  10.75110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  990 7.33226  9.56638 9.92978 7.04352 7.14927 6.05410 1.407250   2.25832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  184 7.63495  8.28041 9.92761 6.72229 6.50598 6.10753 1.407250   2.25832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  991 7.71761  9.11156 9.91618 7.18259 7.07855 6.16031 1.407250   2.25832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  183 6.79302  6.39403 9.92025 6.76006 6.23524 6.10494 1.407250   2.25832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  975 6.44927  7.76908 9.92113 6.89202 6.38918 5.88140 1.407250   2.25832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  510 8.36696  9.86256 9.89898 7.34607 7.10587 6.61334 1.407250   2.25832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  976 7.26088  6.53771 9.92084 6.96297 6.45627 5.63952 1.407250   2.25832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  305 6.57806 10.32370 9.70741 7.18129 7.95357 6.68403 0.941242   0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   48 8.94133  8.89344 9.76620 6.57319 7.46929 7.09027 0.941242   0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  544 5.76832  7.56743 9.68472 7.07977 8.05148 5.94517 0.941242   0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 1002 5.91562  9.84392 9.74486 7.08293 7.92710 5.87879 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 1003 5.85396  9.57639 9.74538 7.19933 7.96247 6.22910 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  191 7.04490 10.48240 9.75845 7.14172 7.86279 6.09166 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 1004 7.22372 10.23640 9.70496 7.63960 8.26740 7.16855 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  187 7.46123  9.15915 9.71533 7.57044 8.21326 7.11444 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  995 6.16533  9.13465 9.64341 6.36002 8.27941 6.92502 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  640 9.65128 11.31550 9.71856 6.64810 7.96881 6.00015 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  185 6.75336 11.54640 9.72137 6.40432 7.92675 6.01485 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  186 6.75782  9.88451 9.71611 7.62061 8.23178 7.18594 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  542 6.81431  8.54922 9.63861 7.18116 8.37391 6.38286 2.866570   2.08476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  165 7.80049  9.00639 9.15882 7.95475 7.32233 6.79457 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  155 8.45877  9.14783 9.12435 7.70243 7.12462 6.95931 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  157 8.45267  8.09617 9.12652 7.65767 7.06754 6.98893 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33   79 8.56406  5.29616 9.12581 7.77669 7.20131 6.83696 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  112 8.41125  7.89692 9.02285 7.52898 7.60357 5.66579 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  158 8.92698  8.33687 9.13184 7.64895 7.02301 7.02868 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  884 7.55678  7.85011 9.11186 7.81621 7.34735 6.58003 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37    1 8.63880 10.97180 9.03807 7.38706 7.50760 5.61153 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  164 7.53140 10.01800 9.01294 7.72827 7.64932 5.87202 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  174 8.22883  9.48070 9.02293 7.48346 7.59182 5.40304 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  547 9.52909  4.72180 9.18782 8.13285 7.56351 6.35573 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  156 8.25099  8.96954 9.13146 7.77387 7.16582 6.88552 2.296760   8.92581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42    3 8.11774  9.87884 8.80295 6.76108 5.51591 6.37044 2.625880   2.29662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  605 7.27915  8.22380 9.00097 5.75406 7.23258 5.80163 2.625880   2.29662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  137 8.00299  9.20029 8.87777 6.87581 5.62608 5.89557 2.625880   2.29662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  606 7.05708  9.72113 8.97459 6.19309 7.07984 5.47498 2.625880   2.29662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46   41 9.08469  8.68191 8.50677 4.63046 7.44178 5.96059 1.393050   2.62490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  138 6.44894  9.42679 8.44812 6.33522 7.36762 5.69235 1.393050   2.62490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  621 7.87562  3.94158 8.31624 5.63957 7.06336 5.59615 1.393050   2.62490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  143 8.37008  9.21999 8.39678 6.29016 7.25234 5.99851 1.393050   2.62490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  147 9.51180  8.13649 8.46924 5.50417 7.35118 5.25879 1.393050   2.62490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    district.id year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            3    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            3    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7            3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9            3    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10           5    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           5    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           5    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           5    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14           5    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15           5    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           5    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17           7    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18           7    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19           7    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20           8    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21           8    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22           8    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23           8    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24           8    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25           8    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26           8    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27           8    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28           8    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29           8    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30           9    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31           9    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32           9    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33           9    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34           9    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35           9    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36           9    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37           9    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38           9    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39           9    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40           9    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41           9    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42          10    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43          10    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44          10    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45          10    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46          11    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47          11    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48          11    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49          11    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50          11    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the number of individuals within each neighbourhood</span></span></span>
<span class="r-in"><span><span class="va">MM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">model.data</span><span class="op">$</span><span class="va">district.id</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the total number of neighbourhood, 100</span></span></span>
<span class="r-in"><span><span class="va">Utotal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">MM</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Unum</span> <span class="op">&lt;-</span> <span class="va">MM</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Uid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">Utotal</span><span class="op">)</span>,<span class="va">Unum</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">model.data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="va">Utotal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Utotal</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">Delta</span><span class="op">[</span><span class="va">Uid</span><span class="op">==</span><span class="va">i</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Delta[1:50,1:10]</span></span></span>
<span class="r-in"><span><span class="va">Delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">Delta</span>,<span class="st">"dgCMatrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract the district level spatial weights matrix using the queen's rule</span></span></span>
<span class="r-in"><span><span class="va">nb.list</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="va">Beijingdistricts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat.list</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html" class="external-link">nb2mat</a></span><span class="op">(</span><span class="va">nb.list</span>,style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">mat.list</span>,<span class="st">"dgCMatrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract the land parcel level spatial weights matrix</span></span></span>
<span class="r-in"><span><span class="va">nb.25</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/dnearneigh.html" class="external-link">dnearneigh</a></span><span class="op">(</span><span class="va">land</span>,<span class="fl">0</span>,<span class="fl">2500</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 4 sub-graphs</span>
<span class="r-in"><span><span class="co"># to a weights matrix</span></span></span>
<span class="r-in"><span><span class="va">dist.25</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nbdists.html" class="external-link">nbdists</a></span><span class="op">(</span><span class="va">nb.25</span>,<span class="va">land</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dist.25</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dist.25</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">/</span> <span class="fl">2500</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat.25</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html" class="external-link">nb2mat</a></span><span class="op">(</span><span class="va">nb.25</span>,glist<span class="op">=</span><span class="va">dist.25</span>,style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">mat.25</span>,<span class="st">"dgCMatrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## run the hsar() function</span></span></span>
<span class="r-in"><span><span class="va">res.formula</span> <span class="op">&lt;-</span> <span class="va">lnprice</span> <span class="op">~</span> <span class="va">lnarea</span> <span class="op">+</span> <span class="va">lndcbd</span> <span class="op">+</span> <span class="va">dsubway</span> <span class="op">+</span> <span class="va">dpark</span> <span class="op">+</span> <span class="va">dele</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="va">popden</span> <span class="op">+</span> <span class="va">crimerate</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">betas</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">res.formula</span>,data<span class="op">=</span><span class="va">landprice</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> rho <span class="op">=</span> <span class="fl">0.5</span>,lambda <span class="op">=</span> <span class="fl">0.5</span>, sigma2e <span class="op">=</span> <span class="fl">2.0</span>, sigma2u <span class="op">=</span> <span class="fl">2.0</span>, betas <span class="op">=</span> <span class="va">betas</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">hsar</span><span class="op">(</span><span class="va">res.formula</span>,data<span class="op">=</span><span class="va">model.data</span>,W<span class="op">=</span><span class="va">W</span>,M<span class="op">=</span><span class="va">M</span>,Delta<span class="op">=</span><span class="va">Delta</span>,</span></span>
<span class="r-in"><span>              burnin<span class="op">=</span><span class="fl">500</span>, Nsim<span class="op">=</span><span class="fl">1000</span>, thinning <span class="op">=</span> <span class="fl">1</span>, parameters.start<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># visualise the district level random effect</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/" class="external-link">classInt</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">Mus</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html" class="external-link">classIntervals</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">4</span>,<span class="st">"fisher"</span><span class="op">)</span><span class="op">$</span><span class="va">brks</span></span></span>
<span class="r-in"><span>  <span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">breaks</span>,include.lowest<span class="op">=</span><span class="cn">TRUE</span>,labels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"Blues"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Beijingdistricts</span>,col<span class="op">=</span><span class="va">palette</span><span class="op">[</span><span class="va">groups</span><span class="op">]</span>,border<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Guanpeng Dong, Wenbo Lv, Richard Richard, Angelos Mimis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

